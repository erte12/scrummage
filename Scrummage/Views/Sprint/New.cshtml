@using System.Collections
@using Microsoft.Ajax.Utilities
@model Scrummage.ViewModels.SprintNewViewModel

@{
    ViewBag.Title = "Create new sprint";
}

<h2>New sprint - Team: @Model.Team.Name</h2>
<hr/>
@if (Request.UrlReferrer != null)
{
<div class="row">
    <div class="col-lg-2">
        <a href="@Request.UrlReferrer" class="btn btn-primary">Back</a>
    </div>
</div>
}
<hr/>

@using (@Html.BeginForm("Save", "Sprint", "POST"))
{
    <div class="form-group">
        @Html.LabelFor(m => m.Name)
        @Html.TextBoxFor(m => m.Name, new {@class="form-control"})
        @Html.ValidationMessageFor(m => m.Name)
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Description)
        @Html.TextAreaFor(m => m.Description, new {@class="form-control"})
        @Html.ValidationMessageFor(m => m.Description)
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="form-group">
                <label for="startsAt" class="control-label">Starts at:</label>
                <div class="input-group" date id="startsAt">
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                    <input name="startsAt" type="text" class="form-control"/>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <label for="endsAt" class="control-label">Ends at:</label>
                <div class="input-group" date id="endsAt">
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                    <input name="endsAt" type="text" class="form-control"/>
                </div>
            </div>
        </div>
    </div>

    @Html.HiddenFor(m => m.Team.Id)
    @Html.AntiForgeryToken()
    <button type="submit" class="btn btn-default">Submit</button>
}

@section scripts
{
    @Scripts.Render("~/bundles/jqueryval")

    <script>

        $('#startsAt').datetimepicker();
        $('#endsAt').datetimepicker();

        $('#startsAt').datetimepicker();
        $('#endsAt').datetimepicker({
            useCurrent: false //Important! See issue #1075
        });
        $("#startsAt").on("dp.change", function (e) {
            $('#endsAt').data("DateTimePicker").minDate(e.date);
        });
        $("#endsAt").on("dp.change", function (e) {
            $('#startsAt').data("DateTimePicker").maxDate(e.date);
        });

        @if (ViewBag.TeamHasNoSprints == true)
        {
            @:bootbox.alert("This team doesn't have any sprints. Create first one.");
        }

    </script>
}


